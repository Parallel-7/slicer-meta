# Slicer Meta Parser

A TypeScript library for parsing metadata from 3D printing slicer files. This library extracts key information from G-Code, GX, and 3MF files, such as slicer information, print settings, and filament usage.

## Features

- Parses metadata from various slicer file formats.
- Supports G-Code, GX, and 3MF files.
- Automatically detects the file type based on the extension.
- Provides a simple, unified interface for different file types.

## Installation

To install this package, you need to configure npm to use the GitHub Packages registry.

Add the following to a `.npmrc` file in your project's root directory:

```
@parallel-7:registry=https://npm.pkg.github.com/
```

Then, install the package as usual:

```bash
npm install @parallel-7/slicer-meta
```

You will need to authenticate with GitHub Packages to download private packages.

## Usage

The primary way to use the library is with the `parseSlicerFile` function, which automatically handles different file formats.

```typescript
import { parseSlicerFile } from '@parallel-7/slicer-meta';

async function main() {
  try {
    const filePath = 'path/to/your/file.gcode';
    const metadata = await parseSlicerFile(filePath);

    console.log('Slicer Info:', metadata.slicer);
    console.log('File Info:', metadata.file);

    if (metadata.threeMf) {
      console.log('3MF Specific Info:', metadata.threeMf);
    }
  } catch (error) {
    console.error('Failed to parse file:', error);
  }
}

main();
```

## Advanced Usage

For more specific use cases, you can use the individual parsers directly. This can be useful if you know the file type in advance or need more control over the parsing process.

The following parsers are available:

- **`GCodeParser`**: A universal parser for G-code files. It automatically detects the slicer (`FlashPrint`, `Orca-FlashForge`, or `Legacy GX`) based on the file's header and delegates to the appropriate specialized parser. This is the recommended parser for most G-code files.

- **`FlashPrintParser`**: Parses G-code files generated by the **FlashPrint** slicer. It extracts basic metadata like printer model and filament type from the file's comments.

- **`OrcaFlashForgeParser`**: Specifically designed for G-code files from **Orca Slicer** (particularly the FlashForge version). It handles the detailed block-based metadata format, extracting information on filament usage, print time estimates, and Base64 encoded thumbnails.

- **`GXParser`**: Handles `.gx` files, which are a binary format used by older FlashForge printers. It can extract the embedded thumbnail and parse G-code comments to determine printer model, filament type, and other metadata. It supports both native `.gx` files from FlashPrint and `.gx` files that were converted from standard G-code.

- **`ThreeMfParser`**: Parses `.3mf` files, which are ZIP archives containing model, metadata, and G-code information. This parser is optimized for `.3mf` files created by **Orca Slicer** (FlashForge version). It extracts a rich set of data, including printer settings, detailed filament information (type, color, usage), model filenames, and the plate thumbnail image. It also internally uses the `GCodeParser` to analyze the embedded G-code for additional details.

### Example

```typescript
import { GCodeParser } from '@parallel-7/slicer-meta';

async function parseGCode() {
  const parser = new GCodeParser();
  await parser.parse('path/to/your/file.gcode');

  console.log('Slicer Info:', parser.slicerInfo);
  console.log('File Info:', parser.fileInfo);
}

parseGCode();
```
